"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[228],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>u});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=a.createContext({}),m=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l=function(e){var t=m(e.components);return a.createElement(i.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=m(n),u=o,h=p["".concat(i,".").concat(u)]||p[u]||d[u]||r;return n?a.createElement(h,s(s({ref:t},l),{},{components:n})):a.createElement(h,s({ref:t},l))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=p;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:o,s[1]=c;for(var m=2;m<r;m++)s[m]=n[m];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},7426:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>c,toc:()=>m});var a=n(7462),o=(n(7294),n(3905));const r={sidebar_position:3},s="Commands",c={unversionedId:"basic-concepts/commands",id:"basic-concepts/commands",title:"Commands",description:"Commands are the second most important building block in Krok. They come right after repositories. Commands define the",source:"@site/docs/basic-concepts/commands.md",sourceDirName:"basic-concepts",slug:"/basic-concepts/commands",permalink:"/docs/basic-concepts/commands",draft:!1,editUrl:"https://github.com/krok-o/docs/tree/main/packages/create-docusaurus/templates/shared/docs/basic-concepts/commands.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Repositories",permalink:"/docs/basic-concepts/repositories"},next:{title:"Events",permalink:"/docs/basic-concepts/events"}},i={},m=[{value:"What are commands",id:"what-are-commands",level:2},{value:"Command configuration",id:"command-configuration",level:3},{value:"How to write a command",id:"how-to-write-a-command",level:2},{value:"SDK",id:"sdk",level:3},{value:"What language to use",id:"what-language-to-use",level:3},{value:"Required arguments",id:"required-arguments",level:3},{value:"Platform Support",id:"platform-support",level:3}],l={toc:m};function d(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"commands"},"Commands"),(0,o.kt)("p",null,"Commands are the second most important building block in Krok. They come right after repositories. Commands define the\nactual commands that can be executed on an event. They have a lot of configuration so let's go through each."),(0,o.kt)("h2",{id:"what-are-commands"},"What are commands"),(0,o.kt)("p",null,"Commands define executable actions which can be taken for an event. For example, a Slack-Notification commands can send\nany kind of configured slack message based on an event. Let's look at how that looks like."),(0,o.kt)("h3",{id:"command-configuration"},"Command configuration"),(0,o.kt)("p",null,"This is the anatomy of a command configuration:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: delivery.krok.app/v1alpha1\nkind: KrokCommand\nmetadata:\n  name: slack-command\n  namespace: krok-system\nspec:\n  enabled: true\n  image: localhost:5001/krok-o/slack-notification:v0.0.2\n  platforms:\n    - github\n  readInputFromSecrets:\n    - name: slack-secret\n      namespace: krok-system\n")),(0,o.kt)("p",null,"What's happening here then? ",(0,o.kt)("inlineCode",{parentName:"p"},"enabled")," is self explanatory. If the command is disabled, it won't be executed."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note"),": This might change to ",(0,o.kt)("inlineCode",{parentName:"p"},"suspended")," in the future to not have to define this attribute on every command."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"platforms")," is a list of platforms that this command can support. This means, that this command understands each\nplatform's payload and can call the right method to get the right data it would need to execute on. It's also possible\nthat the command just simply doesn't care because what it does is not dependent on a platform. Such as, just sending the\nname and the event type to a slack channel."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"readInputFromSecrets")," defines a list of secrets that the user can configure ( or other commands might create secrets\nas output which depending commands can read input from ) from which key-value pairs are then passed over to the command\nas arguments."),(0,o.kt)("p",null,"For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: v1\nkind: Secret\ntype: Opaque\nmetadata:\n  name: wait-command-args\n  namespace: krok-system\ndata:\n  channel: MzBz\n  # Slack token, not provider token\n  token: MzBz\n  message: MzBz\n")),(0,o.kt)("p",null,"The command will read these and pass them as arguments. The command might also declare dependencies."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: delivery.krok.app/v1alpha1\nkind: KrokCommand\nmetadata:\n  name: slack-command\n  namespace: krok-system\nspec:\n  enabled: true\n  image: localhost:5001/krok-o/slack-notification:v0.0.2\n  platforms:\n    - github\n  readInputFromSecrets:\n    - name: slack-secret\n      namespace: krok-system\n  dependencies:\n    - setup-command\n    - generate-artifact-command\n")),(0,o.kt)("p",null,"These dependencies then need to be added to the repository object so they can execute and pass over any information they\ndeclare to the next command."),(0,o.kt)("h2",{id:"how-to-write-a-command"},"How to write a command"),(0,o.kt)("p",null,"So, what does a command look like? You can find all commands written by Krok ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/krok-o/commands"},"here"),".\n",(0,o.kt)("em",{parentName:"p"},"Note"),": At the time of this writing there are only a handful of commands available to choose from."),(0,o.kt)("h3",{id:"sdk"},"SDK"),(0,o.kt)("h3",{id:"what-language-to-use"},"What language to use"),(0,o.kt)("p",null,"Virtually any language can be used that can produce an executable and get understand basic command line options."),(0,o.kt)("h3",{id:"required-arguments"},"Required arguments"),(0,o.kt)("h3",{id:"platform-support"},"Platform Support"))}d.isMDXComponent=!0}}]);